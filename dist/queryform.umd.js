(function(a,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):(a=typeof globalThis<"u"?globalThis:a||self,a.QueryForm=t())})(this,function(){"use strict";var m=a=>{throw TypeError(a)};var U=(a,t,n)=>t.has(a)||m("Cannot "+n);var p=(a,t,n)=>t.has(a)?m("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,n);var i=(a,t,n)=>(U(a,t,"access private method"),n);var t,g,y,w,b,l,S,x,T;class a{constructor(e=null,s="https://queryform.co/api/website/"){p(this,t);this.websiteId=e,this.domainUTMs=[],this.apiRoute=s}async init(e={debug:!1,local:!1},s=[]){e.debug&&i(this,t,b).call(this),e.local?await i(this,t,y).call(this,s):await i(this,t,g).call(this),await i(this,t,w).call(this)}getStoredParams(){return i(this,t,l).call(this)?JSON.parse(localStorage.getItem("queryform_data"))||{}:{}}}return t=new WeakSet,g=async function(){try{const e=await fetch(`${this.apiRoute}${this.websiteId}`);e.ok?this.domainUTMs=await e.json():console.warn("Failed to fetch domain parameters:",e.statusText)}catch(e){console.warn("Error fetching domain parameters:",e)}},y=async function(e){if(!Array.isArray(e)){console.warn("Invalid utms array:",e);return}if(e.some(({param:s,class_name:o})=>!s||!o)){console.warn("Invalid utms array sub-items:",e);return}this.domainUTMs=e},w=function(){const e=i(this,t,S).call(this);i(this,t,x).call(this,e);const s=this.getStoredParams();Object.keys(s).length>0&&i(this,t,T).call(this,s,this.domainUTMs)},b=function(){console.log("%c Queryform%c v1.0%c Data synced.","background: #222; color: #2563eb; padding: 10px;","background: #222; color: #fff; font-size:8px; padding: 12px 10px;","background: #222; color: #777; font-size:8px; padding: 12px 10px;")},l=function(){return typeof Storage<"u"},S=function(){const e=new URLSearchParams(window.location.search),s={};return this.domainUTMs.forEach(({param:o})=>{e.has(o)&&(s[o]=e.get(o))}),Object.keys(s).length>0?s:null},x=function(e){if(!i(this,t,l).call(this)||!e)return;const s=this.getStoredParams()||{};return this.domainUTMs.forEach(({param:o,class_name:u})=>{e[o]&&(s[o]={class_name:u,value:e[o]})}),localStorage.setItem("queryform_data",JSON.stringify(s)),s},T=function(e,s){const o=Object.values(e).map(({class_name:r})=>`.${r}`);document.querySelectorAll(o.join(",")).forEach(r=>{var h;const f=r.tagName.toLowerCase()==="input"?r:r.querySelector("input");if(!f)return;const d=r.className.split(" ").find(c=>o.includes(`.${c}`));if(d){const c=s.find(({class_name:P})=>P===d);c&&(f.value=((h=e[c.param])==null?void 0:h.value)||"")}})},a});
//# sourceMappingURL=queryform.umd.js.map
